{"version":3,"sources":["index.js"],"names":["express","require","router","Router","Employee","catchErrors","bcrypt","generateHash","password","hash","comparePassword","compare","validateForm","form","name","id","length","get","req","res","next","render","title","route","post","console","log","body","findOne","where","ID","user","flash","redirect","PWD","session","authorization","authorization_no","err","create","dept_no","education","work_experience","module","exports"],"mappings":"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","sourcesContent":["var express = require('express');\nvar router = express.Router();\nvar Employee = require('../models/emp');\nconst catchErrors = require('../lib/async-error');\nvar bcrypt = require('bcrypt');\n\nfunction generateHash(password){\n  return bcrypt.hash(password, 10);\n}\n\nfunction comparePassword(password, hash){\n  return bcrypt.compare(password, hash);\n}\n\nfunction validateForm(form){\n  var name = form.name || \"\";\n  var id = form.id || \"\";\n  var password = form.password || \"\";\n\n  if(!name) {\n    return '이름을 입력해주세요.';\n  }\n\n  if(name.length < 2) {\n    return '이름은 두 글자 이상 입력해주세요.';\n  }\n\n  if (!id) {\n    return 'ID를 입력해주세요.';\n  }\n\n  if (!password) {\n    return '비밀번호를 입력해주세요.';\n  }\n\n  // if (password !== password_confirmation) {\n  //   return '비밀번호가 일치하지 않습니다.';\n  // }\n\n  if (password.length < 7) {\n    return '비밀번호가 너무 짧습니다. (8자 이상)';\n  }\n\n  return null;\n}\n\n/* GET index listing. */\nrouter.get('/', function(req, res, next) {\n  res.render('index', { title: 'Index' });\n});\n\nrouter.get('/signup', (req, res) => {\n  res.render('signup', {});\n});\n\nrouter.route('/signin')\n  .get((req, res) => {\n    res.render('signin', {});\n  })\n\n  .post(catchErrors(async (req, res, next) => {\n    console.log(req.body);\n\n    const user = await Employee.findOne({ where: { ID: req.body.id } });\n    if(!user){\n      req.flash('danger', 'Not exist user.');\n      return res.redirect('back');\n    }\n\n    const compare = await comparePassword(req.body.password, user.PWD);\n    if(!compare){\n      req.flash('danger', 'Passsword do not match.');\n      return res.redirect('back');\n    }\n\n    req.session.user = user;\n    req.session.authorization = user.authorization_no;\n    req.flash('success', 'Welcome!');\n    return res.redirect('/');\n  }));\n\nrouter.post('/signup', catchErrors(async (req, res, next) => {\n  console.log(req.body);\n\n  var err = validateForm(req.body);\n  if(err){\n    req.flash('danger', err);\n    return res.redirect('back');\n  }\n\n  var user = await Employee.findOne({id: req.body.id});\n\n  if(user) {\n    req.flash('danger', '이미 존재하는 ID 입니다.');\n    return res.redirect('back');\n  }\n\n  var password = await generateHash(req.body.password);\n\n  user = await Employee.create({\n    name: req.body.name,\n    ID: req.body.id,\n    PWD: password,\n    dept_no: null,\n    authorization_no: null,\n    education: null,\n    work_experience: null\n  });\n\n  req.flash('success', 'Registered successfully. Please sign in.');\n  res.redirect('/');\n}));\n\nrouter.get('/signout', (req, res, next) => {\n  delete req.session.user;\n  req.flash('success', 'Successfully signed out.');\n  res.redirect('/');\n});\n\n\nrouter.get('/test', function(req, res, next) {\n  res.render('index2', { title: 'Express', name: 'han sh' });\n});\n/*회원가입 화면*/\nrouter.get('/test3', function(req, res, next){\n  res.render('signup', { title: 'Express' });\n}); \n\n/*nav_개발자*/\nrouter.get('/nav_developer', function(req, res, next){\n  res.render('nav_develop', { title: 'Express' });\n});\n\n/*nav_경영진*/\nrouter.get('/nav_management', function(req, res, next){\n  res.render('nav_management', { title: 'Express' });\n});\n\n/*프로젝트 등록 페이지*/\nrouter.get('/addproject', function(req, res, next){\n  res.render('addProject', { title: 'Express' });\n});\n\n/*개인정보 수정*/\nrouter.get('/myprofileedit', function(req, res, next){\n  res.render('myProfileEdit', { title: 'Express' });\n});\n\n/*project list*/\nrouter.get('/project/list', function(req, res, next){\n  res.render('project/list', { title: 'Express' });\n});\n\n/*project create*/\nrouter.get('/project/new', function(req, res, next){\n  res.render('project/new', { title: 'Express' });\n});\n\n/*project details*/\nrouter.get('/project/details', function(req, res, next){\n  res.render('project/details', { title: 'Express' });\n});\n\n/*project modify*/\nrouter.get('/project/modify', function(req, res, next){\n  res.render('project/modify', { title: 'Express' });\n});\n\nmodule.exports = router;\n"],"file":"index.dev.js"}